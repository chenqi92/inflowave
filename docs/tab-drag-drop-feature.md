# Tab拖拽分离功能使用说明

## 🎯 功能概述

Tab拖拽分离功能允许用户通过拖拽操作将查询标签页分离到新窗口中，提供更灵活的多窗口工作体验。

## 🚀 功能特性

### 1. **智能拖拽检测**
- 只有拖拽距离超过阈值才会触发分离操作
- 拖拽过程中显示视觉反馈和提示信息
- 支持取消操作（按ESC键或拖回原位置）

### 2. **分离到新窗口**
- 拖拽Tab到窗口边缘可以分离到新窗口
- 支持SQL查询和数据浏览两种类型的Tab
- 新窗口保持与原Tab相同的内容和状态

### 3. **Tab类型支持**
- **SQL查询Tab**: 在新窗口中显示代码编辑器
- **数据浏览Tab**: 在新窗口中显示表格数据
- **表设计器Tab**: 显示表结构设计界面
- **数据库设计器Tab**: 显示数据库架构

### 4. **视觉反馈**
- 拖拽开始时显示自定义拖拽图像
- 拖拽过程中显示半透明覆盖层和提示信息
- 拖拽的Tab在原位置变为半透明状态

## 📋 使用方法

### 基本拖拽操作
1. **开始拖拽**: 在Tab上按住鼠标左键并移动
2. **分离Tab**: 拖拽到窗口边缘（距离边缘50px内）
3. **取消操作**: 拖回原位置或按ESC键

### 分离到新窗口
1. 选择要分离的Tab
2. 按住鼠标左键开始拖拽
3. 拖拽到屏幕边缘
4. 松开鼠标，Tab将在新窗口中打开

### 新窗口操作
- **重新附加**: 点击"重新附加"按钮或使用快捷键Ctrl+D
- **保存内容**: 在SQL编辑器中使用Ctrl+S保存
- **关闭窗口**: 点击关闭按钮或使用Ctrl+W

## ⌨️ 快捷键

| 快捷键 | 功能 |
|--------|------|
| `拖拽` | 开始Tab拖拽操作 |
| `ESC` | 取消拖拽操作 |
| `Ctrl+D` | 重新附加到主窗口 |
| `Ctrl+S` | 保存Tab内容 |
| `Ctrl+W` | 关闭分离窗口 |

## 🎨 视觉指南

### 拖拽状态提示
- **开始拖拽**: Tab变为半透明，显示拖拽图标
- **可分离区域**: 屏幕边缘高亮显示
- **分离成功**: 显示成功消息，新窗口打开

### 分离窗口界面
- **标题栏**: 显示Tab图标、标题和数据库信息
- **控制按钮**: 重新附加、最小化、最大化、关闭
- **内容区域**: 根据Tab类型显示相应内容
- **状态栏**: 显示快捷键提示和状态信息

## 🔧 技术实现

### 核心组件
- `useSimpleTabDrag`: 拖拽逻辑处理Hook
- `SimpleDragOverlay`: 拖拽过程中的覆盖层组件
- `DetachedTabWindow`: 分离窗口的内容组件

### 数据同步
- 分离的Tab与主窗口保持数据同步
- 修改内容会自动同步到原Tab
- 支持双向数据绑定

### 浏览器兼容性
- 支持现代浏览器的原生拖拽API
- 使用window.open()创建新窗口
- 兼容Chrome、Firefox、Safari、Edge

## 🚧 当前限制

### 功能限制
1. **演示版本**: 当前为简化演示版本，新窗口是独立的浏览器窗口
2. **数据同步**: 简化版本中新窗口与主窗口的数据同步有限
3. **窗口管理**: 无法实现完整的窗口状态管理和恢复

### 浏览器限制
1. **弹窗拦截**: 某些浏览器可能拦截新窗口的打开
2. **跨域限制**: 在某些环境中可能受到跨域策略限制
3. **窗口特性**: 新窗口的某些特性可能受到浏览器安全策略限制

## 🔮 未来计划

### 完整版功能
1. **真正的窗口分离**: 使用Tauri的多窗口API实现真正的窗口分离
2. **完整数据同步**: 实现分离窗口与主窗口的完整数据同步
3. **窗口状态管理**: 保存和恢复窗口位置、大小等状态
4. **拖拽重新组合**: 支持将分离的窗口拖回主窗口

### 增强功能
1. **多屏幕支持**: 在多显示器环境中优化使用体验
2. **窗口分组**: 支持将多个Tab分离到同一个窗口中
3. **自定义布局**: 允许用户自定义分离窗口的布局
4. **会话恢复**: 应用重启后恢复分离窗口的状态

## 📞 问题反馈

如果在使用Tab拖拽功能时遇到问题，请：
1. 检查浏览器的弹窗设置
2. 确保JavaScript已启用
3. 尝试在不同浏览器中测试
4. 查看浏览器控制台是否有错误信息

---

*这是一个演示功能，在实际的Tauri应用中会有更完整的实现。*