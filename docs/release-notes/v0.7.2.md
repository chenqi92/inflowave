# InfloWave v0.7.2 发布说明

## 🎉 用户体验优化版本

### 📦 核心改进

本版本专注于提升用户体验和界面交互，优化了查询功能、数据展示和主题系统，修复了多个关键问题。

## ✨ 新增功能

### 🎨 主题系统增强
- **新增** macOS 窗口背景色主题同步功能
- **实现** Tauri 窗口主题自动跟随系统主题切换
- **优化** 深浅色主题切换的流畅性和一致性
- **添加** 详细的主题同步日志，便于调试

### 📊 数据表格功能增强
- **实现** GlideDataTable 表格列宽可调整并持久化
- **新增** 客户端和服务器端分页功能
- **添加** 数据懒加载预取功能，提升加载体验
- **支持** 加载全部数据功能（页面大小设置为 -1）
- **优化** 表格列宽自动计算和分配策略
- **改进** 虚拟滚动性能，支持大数据集流畅展示

### ⚙️ 查询性能优化
- **新增** 查询设置模块，包含超时、最大结果数等配置
- **实现** 懒加载模式开关和批次大小设置
- **添加** 查询自动补全功能配置
- **支持** 在创建查询标签页时传递连接 ID
- **优化** 查询执行逻辑，确保正确关联到具体连接

### 🎯 InfluxDB 适配优化
- **适配** InfluxDB 1.x 语法限制
- **移除** InfluxDB 1.x 不支持的 ASC/DESC 关键字
- **确保** 'time' 字段名保持小写格式
- **添加** InfluxDB 1.x 常用字段自动补全建议
- **修复** SQL 格式化时 databaseType 为 null 的处理

## 🐛 重要修复

### 🔨 UI 组件修复
- **修复** 下拉选择器文本超出宽度时换行的问题
- **优化** SelectContent 组件宽度限制和文本截断
- **添加** title 属性显示完整内容的悬停提示
- **修复** Dialog 组件布局与滚动行为
- **调整** Dialog 背景透明度和最大高度限制

### 📋 数据展示修复
- **修复** UnifiedDataTable 滚动条范围和同步问题
- **优化** 表格行边界可见性
- **修复** 虚拟滚动计算逻辑
- **改进** 水平滚动同步，实现表头和数据完美对齐
- **修复** 查询结果页面大小变更逻辑

### 🔧 编辑器优化
- **拦截** Monaco Editor 剪贴板 API，防止权限请求弹窗
- **过滤** Monaco Editor 的 Canceled 错误，避免冗余日志
- **优化** 错误日志过滤机制

### 🔗 连接管理优化
- **优化** 连接状态同步机制
- **移除** 前端连接状态初始化逻辑，改由后端同步
- **添加** 后端连接状态自动同步处理

## 🎨 界面优化

### 🖼️ 布局改进
- **优化** 侧边栏组件布局和功能
- **简化** 通知面板和性能监控面板的头部结构
- **重构** 垂直开发工具面板，移除标签页结构
- **简化** 连接对话框中的数据库版本显示
- **移除** 冗余的标题和图标显示

### 📐 样式优化
- **优化** 下拉框文本截断显示
- **统一** 数据库、表名等长文本在下拉列表中的显示
- **改善** 连接信息下拉项的布局和文本截断行为
- **优化** 选择器项的最小宽度和弹性布局属性

## 🚀 性能优化

### ⚡ 数据加载优化
- **减少** 数据加载间隔时间（1000ms → 300ms）
- **增加** 每次加载的数据量（100条 → 200条）
- **实现** 预取机制，提供更流畅的滚动体验
- **优化** 懒加载模式下的数据加载流程

### 📊 表格渲染优化
- **优化** 虚拟滚动算法，仅渲染可视区域
- **改进** 列宽计算性能
- **精简** 不必要的重复渲染
- **优化** 滚动条样式和浮动效果

## 🔧 技术改进

### 📋 代码重构
- **重构** TableDataBrowser 组件代码结构
- **简化** 字符串拼接方式，使用模板字符串
- **优化** 对象属性简写，移除冗余声明
- **统一** 变量引用方式，提升代码可读性

### 🛠️ 依赖更新
- **添加** macOS 平台特定依赖 cocoa
- **更新** Tauri 命令权限配置
- **优化** 组件导入和引用关系

### 🔍 调试增强
- **添加** 详细的日志记录
- **增强** 查询设置加载状态日志
- **完善** 懒加载设置检查日志
- **优化** 调试信息输出

## 📦 组件更新

### 🔄 组件替换
- **替换** UnifiedDataTable 为 GlideDataTable
- **更新** 相关组件以使用新的表格组件
- **移除** 旧版 DataTable 格式化逻辑
- **统一** 使用 GlideDataTable 组件

### 🎯 新增组件
- **新增** CustomVirtualizedTable 虚拟化表格组件
- **添加** ContextMenu 组件引用
- **实现** 分页控件组件
- **添加** CSS 变量颜色获取工具函数

## 🔄 兼容性

### 📱 平台支持
- **Windows** 10/11 (x64/x86)
- **macOS** 10.15+ (Intel/Apple Silicon) - 增强主题同步
- **Linux** Ubuntu 20.04+, CentOS 8+, Fedora 35+ (x64/ARM64)

### 🗄️ 数据库支持
- **InfluxDB** 1.x - 优化语法适配
- **InfluxDB** 2.x
- **IoTDB** - 持续支持

## 📝 开发者工具

### 🛠️ 新增配置
```typescript
// 查询设置配置
{
  queryTimeout: number,        // 查询超时时间
  maxResults: number,          // 最大结果数
  enableAutoComplete: boolean, // 启用自动补全
  lazyLoadEnabled: boolean,    // 启用懒加载
  lazyLoadBatchSize: number    // 懒加载批次大小
}
```

### 📋 Tauri 命令
```rust
// 新增窗口背景色设置命令
set_window_background(color: String)

// 查询设置相关命令
get_query_settings()
update_query_settings(settings: QuerySettings)
```

## 🔮 下一步计划

### 🎯 v0.7.3 计划
- **增强** 数据导出功能，支持更多格式
- **优化** 查询历史管理
- **改进** 性能监控面板

### 🚀 v0.8.0 展望
- **新增** 数据可视化图表类型
- **扩展** 插件系统架构
- **增强** 多数据源联合查询

## 🙏 致谢

感谢所有用户的反馈和建议，特别是在 UI 交互和性能优化方面提出宝贵意见的用户。

## 📞 支持

如果您在使用过程中遇到任何问题，请通过以下方式联系我们：

- **GitHub Issues**: [https://github.com/chenqi92/inflowave/issues](https://github.com/chenqi92/inflowave/issues)
- **讨论区**: [https://github.com/chenqi92/inflowave/discussions](https://github.com/chenqi92/inflowave/discussions)
- **邮箱**: support@kkape.com

---

**完整更新日志**: [v0.7.1...v0.7.2](https://github.com/chenqi92/inflowave/compare/v0.7.1...v0.7.2)

