# InfloWave v0.8.5 发布说明

## 🚀 应用更新系统与稳定性提升

本版本专注于应用更新体验的完善和系统稳定性的提升，修复了打包后应用初始化卡顿的关键问题，并增强了自动更新功能的交互体验。

---

## ✨ 重要特性

### 🔄 自动更新功能增强

#### 更新检查体验优化
- **新增** 检查更新时显示更新对话框，提供完整的更新操作界面
- **新增** 一键更新功能（Windows 平台）
- **新增** 跳过版本功能，允许用户跳过特定版本
- **新增** 查看详情按钮，可直接跳转到 GitHub Release 页面
- **改进** 检查更新时显示 "正在检查更新..." 提示
- **优化** 更新对话框显示版本信息、发布说明和平台信息

#### 发布说明查看器
- **修复** 版本号格式处理，避免 `vv0.8.4` 错误格式
- **优化** 版本号规范化逻辑，自动处理带 `v` 前缀和不带前缀的版本号
- **改进** 发布说明加载失败时的回退处理

### 🛡️ 系统稳定性

#### 日志系统修复
- **修复** 打包后应用初始化卡顿的关键问题
- **修复** 日志系统无限循环导致的 CPU 占用过高
- **新增** 日志写入递归保护机制
- **优化** 文件信息获取失败时的静默处理
- **改进** 循环依赖检测，避免日志写入死锁

#### 资源文件打包
- **修复** 打包后发布说明文件无法读取的问题
- **新增** 多路径搜索机制，兼容开发和生产环境
- **配置** Tauri 资源打包，包含 `docs/release-notes/*` 文件
- **优化** 发布说明文件路径解析逻辑

---

## 🛠️ 修复与细节优化

### 核心修复
- 修复打包后应用启动时一直处于初始化状态的问题
- 修复日志系统 `getFileInfo` 失败导致的无限循环
- 修复 GitHub API 请求版本号格式错误 (`vv0.8.4` → `v0.8.4`)
- 修复本地发布说明文件路径在生产环境中无效的问题

### 更新系统
- 修复检查更新后只显示消息不提供操作按钮的问题
- 优化更新对话框的用户交互流程
- 改进更新状态的展示和反馈

### 国际化
- 新增 "正在检查更新..." 多语言翻译 (中/英)

---

## 📁 技术改进

### 前端
- `NativeMenuHandler.tsx`: 集成 UpdateNotification 组件
- `fileOperations.ts`: 避免循环依赖，使用原生 console
- `logger.ts`: 添加写入锁和递归保护
- `releaseNotesService.ts`: 版本号格式规范化

### 后端 (Rust)
- `updater.rs`: 重写 `read_release_notes_file`，支持多路径搜索
- `updater.rs`: 重写 `list_release_notes_files`，兼容打包环境
- `tauri.conf.json`: 配置资源文件打包

---

## 🔍 升级建议

1. **所有用户**：
   - 如遇到初始化卡顿问题，请升级到此版本
   - 测试新的检查更新功能（帮助菜单 → 检查更新）
   - 体验完整的更新对话框界面

2. **Windows 用户**：
   - 可使用一键更新功能直接下载安装
   - 支持 MSI 和 EXE 安装包自动识别

3. **其他平台用户**：
   - 点击更新按钮将打开下载页面
   - 支持查看详细发布说明

---

## 🙏 致谢

感谢所有反馈初始化卡顿问题的用户，这帮助我们快速定位并修复了这个关键问题！

欢迎体验 InfloWave v0.8.5，如遇问题欢迎在 [GitHub Issues](https://github.com/chenqi92/inflowave/issues) 中反馈！
