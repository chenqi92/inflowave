# InfloWave v0.4.3

## 🚀 重要架构升级版本

InfloWave v0.4.3 是一个重要的架构升级版本，专注于增强数据库支持、优化性能监控、完善安装体验和提升代码质量。本版本带来了更强大的 InfluxDB 3.x 支持、全新的性能监控系统、稳定的 Windows 安装体验以及大幅的代码架构优化。

## ✨ 核心功能增强

### 🗄️ InfluxDB 3.x 全面支持
- **✅ 原生 InfluxDB 3.x 连接** - 新增完整的 InfluxDB 3.x 数据库支持和连接测试
- **🔍 智能版本检测** - 自动识别和适配 InfluxDB 1.x/2.x/3.x 不同版本
- **📊 增强查询支持** - 优化 InfluxDB 3.x 的查询语法和结果处理
- **🏗️ 连接对话框升级** - 更新连接界面以支持 InfluxDB 3.x 特定配置

### 📊 性能监控系统重构
- **🚀 多数据源性能监控** - 全新的 `MultiSourcePerformanceMonitor` 组件
- **📈 实时性能追踪** - 支持多个数据库连接的并发性能监控
- **⚡ 端口管理增强** - 改进端口冲突检测和自动分配机制
- **🔧 监控组件优化** - 移除旧版 `VerticalPerformanceMonitor`，采用更高效的架构

### 🎨 用户界面优化
- **🌓 图标系统升级** - 新增数据库、存储、测量等功能的明暗主题图标
- **🎯 数据库图标增强** - 完善的 `DatabaseIcon` 组件和图标映射系统
- **🔄 连接管理改进** - 优化连接状态显示和错误处理界面
- **📋 剪贴板功能** - 增强数据复制和粘贴体验

## 🔧 技术架构改进

### 🏗️ 代码架构重构
- **📦 组件清理** - 移除过时的 `DatabaseTree`、`VersionAwareDatabaseExplorer` 等组件
- **🔄 客户端集中化** - 重构 IoTDB 客户端，统一标识符转义和连接刷新策略
- **🌳 树节点系统** - 扩展 InfluxDB 和 IoTDB 的树节点类型和工厂方法
- **🧹 依赖清理** - 移除多个不再使用的组件和相关依赖

### 🔒 连接管理优化
- **🔗 连接池改进** - 优化数据库连接池管理和生命周期
- **⚡ 缓存机制** - 在 `DatabaseExplorer` 中引入数据库缓存管理
- **🛡️ 错误处理** - 新增连接错误处理组件和状态同步逻辑
- **🔄 刷新策略** - 触发数据源树刷新并增强日志记录

### 📱 跨平台体验
- **🖥️ Windows 安装优化** - 从 NSIS 切换到 WIX，解决安装包下载失败问题
- **🌏 多语言支持** - WIX 安装程序支持中英文双语言
- **🎨 主题系统** - 应用主题设置为 Light，优化启动体验
- **⚙️ 环境变量管理** - 使用 `cross-env` 统一管理环境变量

## 🐛 问题修复

### 🔗 连接问题修复
- **🔄 连接测试优化** - 修复 InfluxDB 3.x 连接测试和数据库获取逻辑
- **📊 查询引擎** - 解决多数据库查询引擎的稳定性问题
- **🏷️ 标识符处理** - 统一 IoTDB 客户端的标识符转义逻辑
- **⚡ 响应速度** - 优化用户偏好更新逻辑，减少不必要的保存操作

### 🎨 界面问题修复
- **🖼️ 图标显示** - 修复数据库和功能图标的显示异常
- **📋 上下文菜单** - 优化右键菜单的功能和响应
- **🔄 状态同步** - 改进前后端状态同步机制
- **📱 响应式布局** - 修复不同屏幕尺寸下的显示问题

### 🛠️ 构建和部署修复
- **📦 安装包生成** - 解决 Windows NSIS 安装包下载 503 错误
- **🔧 依赖管理** - 更新和清理项目依赖，移除过时的库
- **🏗️ 构建流程** - 优化 GitHub Actions 构建配置和错误处理
- **📋 配置文件** - 修正 Tauri 配置文件的路径和设置错误

## 📦 技术更新

### 🔧 构建系统
- **🏗️ WIX 安装器** - 完全迁移到 WIX 工具链，生成更稳定的 MSI 安装包
- **⚙️ 配置优化** - 简化 Tauri 配置文件结构，移除冗余设置
- **📋 模板修正** - 修复 WIX 模板文件路径配置错误
- **🔄 回退机制** - 更新 GitHub Actions 中的 Windows 构建回退策略

### 📚 依赖管理
- **🆕 新增依赖** - 添加 `cross-env` 用于跨平台环境变量管理
- **🗑️ 清理依赖** - 移除多个不再使用的组件和库依赖
- **🔒 安全更新** - 更新关键依赖包的安全版本
- **📦 包管理** - 优化 package.json 和 Cargo.toml 依赖结构

### 🧪 开发体验
- **📝 代码文档** - 添加代码使用分析和项目类文档
- **🔍 日志增强** - 改进错误处理和调试日志记录
- **⚡ 开发效率** - 优化开发环境配置和热重载机制
- **🧹 代码清理** - 大幅清理过时代码和未使用的导入

## 🔄 兼容性说明

### 📋 版本兼容性
- **🗄️ InfluxDB 支持** - 向下兼容 InfluxDB 1.x/2.x，新增 3.x 支持
- **🔧 配置文件** - 保持与旧版本配置文件的兼容性
- **📱 平台支持** - 继续支持 Windows、macOS、Linux 全平台
- **🔄 数据迁移** - 自动适配旧版本的连接和设置数据

### ⚠️ 重要变更
- **📦 Windows 安装** - Windows 安装包格式从 NSIS 切换到 MSI (WIX)
- **🏗️ 组件架构** - 移除了多个过时组件，可能影响自定义扩展
- **🔗 连接逻辑** - 数据库连接和查询逻辑有所调整，建议重新测试连接
- **🎨 界面变化** - 部分 UI 组件和图标有更新，界面布局略有调整

## 📈 性能提升

### ⚡ 响应速度
- **🔄 连接性能** - 优化数据库连接建立和维护机制
- **📊 查询优化** - 改进查询执行效率，特别是 InfluxDB 3.x 查询
- **🧠 内存使用** - 通过组件清理和架构优化减少内存占用
- **🚀 启动速度** - 优化应用启动流程和资源加载

### 📦 包体积优化
- **🗑️ 代码清理** - 移除大量未使用的代码和组件
- **📚 依赖精简** - 清理不必要的依赖包，减少最终包体积
- **🎨 资源优化** - 优化图标和静态资源的存储和加载
- **🔧 构建优化** - 改进构建流程，提升打包效率

## 🎯 升级指南

### 🔄 从 0.3.3 升级
1. **备份数据** - 升级前请备份连接配置和用户数据
2. **卸载旧版** - Windows 用户请先卸载旧版本再安装新版本
3. **重新配置** - 部分连接可能需要重新配置以支持新功能
4. **测试连接** - 升级后请测试所有数据库连接的可用性

### 🆕 新用户指南
1. **下载安装** - 从 GitHub Releases 下载对应平台的安装包
2. **首次配置** - 参考文档配置数据库连接
3. **功能探索** - 尝试新的 InfluxDB 3.x 支持和性能监控功能
4. **反馈问题** - 遇到问题请通过 GitHub Issues 反馈

---

> 🏗️ **架构升级**: 本版本进行了大规模的代码架构重构，提升了系统的可维护性和扩展性，为后续功能开发奠定了坚实基础。

> 🗄️ **数据库支持**: 新增 InfluxDB 3.x 支持标志着 InfloWave 在时序数据库管理能力上的重要提升，能够适应更多的使用场景。

> 🔧 **安装体验**: 通过切换到 WIX 安装器，显著提升了 Windows 平台的安装稳定性和用户体验，解决了长期存在的安装问题。