# InfloWave v0.6.2 ä¿®å¤æ€»ç»“

## ğŸ¯ ä¿®å¤ç›®æ ‡

è§£å†³ v0.6.1 ä¸­ Windows MSI å®‰è£…åŒ…æ„å»ºå¤±è´¥çš„é—®é¢˜ï¼Œå¹¶æ–°å¢å¾®è½¯å•†åº—æ‰“åŒ…æ”¯æŒã€‚

## ğŸ› é—®é¢˜åˆ†æ

### åŸå§‹é”™è¯¯
```
Finished `release` profile [optimized] target(s) in 8m 53s
Building MSI installer...
Error[2] (Generic): The 'target/release/InfloWave.exe' file does not exist. 
Consider using the 'cargo wix print WXS > target/release/InfloWave.exe command to create it.
Build failed: WiX build failed
```

### æ ¹æœ¬åŸå› 
1. **æ„å»ºé¡ºåºé—®é¢˜**: MSI æ„å»ºåœ¨ Tauri æ„å»ºä¹‹å‰æ‰§è¡Œï¼Œå¯¼è‡´å¯æ‰§è¡Œæ–‡ä»¶ä¸å­˜åœ¨
2. **è·¯å¾„ä¸åŒ¹é…**: cargo-wix æœŸæœ› `target/release/InfloWave.exe`ï¼Œä½† Tauri ç”Ÿæˆåœ¨ `target/{target}/release/InfloWave.exe`
3. **å·¥å…·é“¾æ··ç”¨**: æ··åˆä½¿ç”¨ cargo-wix å’Œ Tauriï¼Œå¯¼è‡´é…ç½®ä¸ä¸€è‡´
4. **å¹¶è¡Œæ„å»ºå†²çª**: MSI å’Œ EXE æ„å»ºåŒæ—¶è¿›è¡Œï¼Œå¯èƒ½å¯¼è‡´æ–‡ä»¶é”å®š

## ğŸ”§ ä¿®å¤æ–¹æ¡ˆ

### 1. GitHub Workflow ä¿®å¤

#### è°ƒæ•´æ„å»ºé¡ºåº
```yaml
# ä¿®å¤å‰ï¼šMSI å’Œ EXE å¹¶è¡Œæ„å»ºï¼Œå¯¼è‡´æ–‡ä»¶å†²çª
- name: Build Windows MSI (cargo-wix)
- name: Build Windows EXE (Tauri NSIS)

# ä¿®å¤åï¼šå…ˆæ„å»º EXEï¼Œå†æ„å»º MSI å’Œ MSIX
- name: Build Windows EXE (Tauri NSIS)
- name: Build Windows MSI (Tauri)
- name: Build Windows MSIX (Microsoft Store)
```

#### ç»Ÿä¸€æ„å»ºæ–¹å¼
```yaml
# ä¿®å¤å‰ï¼šæ··åˆä½¿ç”¨ cargo-wix å’Œ Tauri
# ä¿®å¤åï¼šç»Ÿä¸€ä½¿ç”¨ Tauri æ„å»ºï¼Œé…ç½®ä¸åŒçš„ bundle targets
```

### 2. Windows æ„å»ºè„šæœ¬ä¼˜åŒ–

#### ç»Ÿä¸€ä½¿ç”¨ Tauri æ„å»º
```powershell
# ä¿®å¤å‰ï¼šä½¿ç”¨ cargo-wix ç›´æ¥æ„å»º MSI
& cargo wix --target $Target

# ä¿®å¤åï¼šä½¿ç”¨ Tauri æ„å»ºï¼ŒæŒ‡å®šæ­£ç¡®çš„é…ç½®æ–‡ä»¶
$tauriCommand = "npm run tauri build --target $Target --config tauri.windows-cargo-wix.conf.json"
Invoke-Expression $tauriCommand
```

#### æ™ºèƒ½è·¯å¾„æ£€æµ‹å’Œå¤åˆ¶
```powershell
# ç¡®ä¿å¯æ‰§è¡Œæ–‡ä»¶åœ¨ WiX æœŸæœ›çš„ä½ç½®
$exePath = "target\$Target\release\InfloWave.exe"
$wixExpectedPath = "target\release\InfloWave.exe"

if (Test-Path $exePath) {
    Copy-Item $exePath $wixExpectedPath -Force
    Write-Host "ğŸ“‹ Copied executable to WiX expected location"
}
```

#### ç¯å¢ƒå˜é‡è®¾ç½®
```powershell
# è®¾ç½®æ­£ç¡®çš„ bundle target
$env:TAURI_BUNDLE_TARGETS = "msi"  # æˆ– "msix"
```

### 3. æ–°å¢ MSIX æ”¯æŒ

#### åˆ›å»º MSIX é…ç½®æ–‡ä»¶
- `src-tauri/tauri.windows-msix.conf.json`
- é…ç½®å¾®è½¯å•†åº—åº”ç”¨çš„ç‰¹å®šè®¾ç½®
- æ”¯æŒæ–‡ä»¶å…³è”å’Œåè®®æ³¨å†Œ

#### MSIX æ„å»ºè„šæœ¬
- `scripts/build-msix.ps1`
- è‡ªåŠ¨æ£€æµ‹å¯æ‰§è¡Œæ–‡ä»¶
- ç”Ÿæˆå¾®è½¯å•†åº—å…¼å®¹çš„åº”ç”¨åŒ…

### 4. éªŒè¯å’Œæµ‹è¯•å·¥å…·

#### Windows åŒ…éªŒè¯å·¥å…·
- `scripts/validate-windows-packages.cjs`
- éªŒè¯ MSIã€EXEã€MSIX åŒ…çš„å®Œæ•´æ€§
- æ£€æŸ¥æ–‡ä»¶å¤§å°ã€å“ˆå¸Œå€¼ç­‰

#### é€šç”¨åŒ…æµ‹è¯•å·¥å…·
- `scripts/test-packages.cjs`
- è·¨å¹³å°å®‰è£…åŒ…æµ‹è¯•
- åŸºæœ¬å®Œæ•´æ€§å’Œç»“æ„éªŒè¯

## ğŸ“¦ æ–°å¢å®‰è£…åŒ…æ ¼å¼

### Windows å¹³å° (6ç§æ ¼å¼)
1. **NSIS å®‰è£…åŒ…** - `InfloWave_0.6.2_x64-setup.exe`
2. **MSI å®‰è£…åŒ…** - `InfloWave_0.6.2_x64.msi` âœ… ä¿®å¤
3. **MSIX åº”ç”¨åŒ…** - `InfloWave_0.6.2_x64.msix` ğŸ†•

### æ”¯æŒçš„æ¶æ„
- x64 (64ä½) - ä¸»è¦æ”¯æŒ
- x86 (32ä½) - å…¼å®¹æ”¯æŒ

## ğŸ› ï¸ æ–°å¢ NPM è„šæœ¬

```json
{
  "build:windows:msi": "powershell -ExecutionPolicy Bypass -File scripts/build-windows.ps1",
  "build:windows:msix": "powershell -ExecutionPolicy Bypass -File scripts/build-msix.ps1",
  "validate:windows:packages": "node scripts/validate-windows-packages.cjs",
  "test:packages:local": "node scripts/test-packages.cjs"
}
```

## ğŸ”„ ç‰ˆæœ¬åŒæ­¥

æ‰€æœ‰é…ç½®æ–‡ä»¶å·²åŒæ­¥åˆ° v0.6.2ï¼š
- âœ… package.json
- âœ… src-tauri/tauri.conf.json
- âœ… src-tauri/tauri.windows-cargo-wix.conf.json
- âœ… src-tauri/tauri.windows-msix.conf.json (æ–°å¢)
- âœ… src-tauri/Cargo.toml
- âœ… æ‰€æœ‰å¹³å°ç‰¹å®šé…ç½®æ–‡ä»¶

## ğŸ“‹ æµ‹è¯•éªŒè¯

### æœ¬åœ°æµ‹è¯•å‘½ä»¤
```bash
# éªŒè¯ç‰ˆæœ¬ä¸€è‡´æ€§
npm run version:check

# æµ‹è¯•æ„å»ºè„šæœ¬è¯­æ³•
powershell -ExecutionPolicy Bypass -File scripts/test-build-scripts.ps1 -SyntaxOnly

# éªŒè¯ Windows åŒ…ï¼ˆæ„å»ºåï¼‰
npm run validate:windows:packages

# æµ‹è¯•æ‰€æœ‰å®‰è£…åŒ…ï¼ˆæ„å»ºåï¼‰
npm run test:packages:local

# ç”Ÿæˆå‘å¸ƒè¯´æ˜
node scripts/generate-release-notes.cjs

# æœ¬åœ°æµ‹è¯• MSI æ„å»ºï¼ˆéœ€è¦ Windows ç¯å¢ƒï¼‰
npm run build:windows:msi

# æœ¬åœ°æµ‹è¯• MSIX æ„å»ºï¼ˆéœ€è¦ Windows ç¯å¢ƒï¼‰
npm run build:windows:msix
```

### GitHub Actions æµ‹è¯•
- æ„å»ºçŸ©é˜µåŒ…å«æ‰€æœ‰å¹³å°å’Œæ¶æ„
- è‡ªåŠ¨ä¸Šä¼  MSIã€EXEã€MSIX æ–‡ä»¶åˆ° Release
- é”™è¯¯å¤„ç†å’Œé‡è¯•æœºåˆ¶

## ğŸ¯ é¢„æœŸç»“æœ

### ä¿®å¤çš„é—®é¢˜
1. âœ… Windows MSI æ„å»ºå¤±è´¥é—®é¢˜
2. âœ… å¯æ‰§è¡Œæ–‡ä»¶è·¯å¾„ä¸åŒ¹é…é—®é¢˜
3. âœ… æ„å»ºé¡ºåºå’Œä¾èµ–é—®é¢˜

### æ–°å¢åŠŸèƒ½
1. ğŸ†• å¾®è½¯å•†åº— MSIX åŒ…æ”¯æŒ
2. ğŸ†• Windows åŒ…éªŒè¯å·¥å…·
3. ğŸ†• é€šç”¨åŒ…æµ‹è¯•å·¥å…·
4. ğŸ†• å¢å¼ºçš„æ„å»ºè„šæœ¬

### æ”¹è¿›çš„æµç¨‹
1. ğŸ”„ æ›´å¯é çš„æ„å»ºé¡ºåº
2. ğŸ”„ æ›´å¥½çš„é”™è¯¯å¤„ç†
3. ğŸ”„ æ›´å®Œæ•´çš„éªŒè¯æœºåˆ¶

## ğŸš€ éƒ¨ç½²å»ºè®®

1. **æäº¤æ›´æ”¹**: å°†æ‰€æœ‰ä¿®å¤æäº¤åˆ°ä¸»åˆ†æ”¯
2. **è§¦å‘æ„å»º**: package.json ç‰ˆæœ¬å˜æ›´å°†è‡ªåŠ¨è§¦å‘ GitHub Actions
3. **éªŒè¯ç»“æœ**: æ£€æŸ¥ç”Ÿæˆçš„æ‰€æœ‰å®‰è£…åŒ…
4. **å‘å¸ƒç‰ˆæœ¬**: ç¡®è®¤æ‰€æœ‰åŒ…æ­£å¸¸åå‘å¸ƒ v0.6.2

## ğŸ“ åç»­æ”¯æŒ

å¦‚æœä»ç„¶é‡åˆ° MSI æ„å»ºé—®é¢˜ï¼š
1. æ£€æŸ¥ Windows æ„å»ºç¯å¢ƒ
2. éªŒè¯ WiX Toolset å®‰è£…
3. æŸ¥çœ‹è¯¦ç»†çš„æ„å»ºæ—¥å¿—
4. ä½¿ç”¨æœ¬åœ°éªŒè¯å·¥å…·è¯Šæ–­

---

**ä¿®å¤å®Œæˆæ—¶é—´**: 2024-08-08  
**å½±å“ç‰ˆæœ¬**: v0.6.2  
**ä¿®å¤ç±»å‹**: å…³é”®ä¿®å¤ + åŠŸèƒ½å¢å¼º
