# 📊 数据可视化

InfloWave 提供了强大的数据可视化功能，基于 ECharts 构建，支持多种图表类型和交互式操作。本指南将详细介绍如何创建和管理数据图表。

## 🎨 可视化概述

### 支持的图表类型
- **折线图** - 时序数据趋势展示
- **柱状图** - 分类数据对比
- **饼图** - 比例数据展示
- **面积图** - 累积数据展示
- **散点图** - 数据分布分析
- **仪表盘** - 单值指标展示

### 核心特性
- **实时刷新** - 支持自动数据更新
- **交互操作** - 缩放、平移、数据点提示
- **响应式设计** - 自适应不同屏幕尺寸
- **主题支持** - 明暗主题切换
- **导出功能** - 图表导出为图片

## 📈 创建第一个图表

### 基本步骤

1. **切换到可视化页面**
   - 点击顶部导航的 **"可视化"** 标签
   - 或使用快捷键 `Ctrl + 3`

2. **新建图表**
   - 点击 **"新建图表"** 按钮
   - 选择图表类型

3. **配置数据源**
   - 选择数据库连接
   - 选择目标数据库
   - 输入查询语句

4. **设置图表属性**
   - 配置 X 轴和 Y 轴
   - 设置图表标题和样式
   - 调整颜色和主题

5. **预览和保存**
   - 点击 **"预览"** 查看效果
   - 满意后点击 **"保存"** 保存图表

### 示例：创建 CPU 使用率折线图

```sql
SELECT MEAN("value") AS "cpu_usage"
FROM "cpu_metrics" 
WHERE time > now() - 1h 
GROUP BY time(5m)
```

**配置说明**：
- **图表类型**: 折线图
- **X 轴**: time (时间字段)
- **Y 轴**: cpu_usage (数值字段)
- **标题**: "CPU 使用率趋势"

## 📊 图表类型详解

### 折线图 (Line Chart)

**适用场景**：
- 时序数据趋势分析
- 多个指标对比
- 连续数据变化展示

**配置要点**：
- X 轴通常为时间字段
- Y 轴为数值字段
- 支持多条线显示

**示例查询**：
```sql
SELECT MEAN("cpu") AS "CPU", MEAN("memory") AS "Memory"
FROM "system_metrics" 
WHERE time > now() - 2h 
GROUP BY time(10m)
```

### 柱状图 (Bar Chart)

**适用场景**：
- 分类数据对比
- 统计数据展示
- 排名分析

**配置要点**：
- X 轴为分类字段
- Y 轴为数值字段
- 支持堆叠和分组显示

**示例查询**：
```sql
SELECT COUNT(*) AS "count"
FROM "error_logs" 
WHERE time > now() - 1d 
GROUP BY "error_type"
```

### 饼图 (Pie Chart)

**适用场景**：
- 比例数据展示
- 组成分析
- 百分比统计

**配置要点**：
- 需要名称和数值两个字段
- 支持环形图显示
- 可设置标签和百分比

**示例查询**：
```sql
SELECT COUNT(*) AS "count"
FROM "user_actions" 
WHERE time > now() - 1d 
GROUP BY "action_type"
```

### 面积图 (Area Chart)

**适用场景**：
- 累积数据展示
- 多层数据叠加
- 总量变化趋势

**配置要点**：
- 类似折线图配置
- 支持堆叠面积图
- 可调整透明度

### 仪表盘 (Gauge)

**适用场景**：
- 单一指标监控
- 阈值告警展示
- 实时状态显示

**配置要点**：
- 只需要一个数值
- 可设置最小值和最大值
- 支持颜色分段

**示例查询**：
```sql
SELECT LAST("value") AS "current_value"
FROM "temperature" 
WHERE time > now() - 5m
```

## 🎛️ 图表配置

### 基本配置

**图表标题**
- 主标题和副标题
- 标题位置和样式
- 字体大小和颜色

**坐标轴配置**
- X 轴和 Y 轴标题
- 刻度间隔和格式
- 轴线样式和颜色

**图例设置**
- 图例位置和方向
- 图例样式和交互
- 显示/隐藏控制

### 高级配置

**数据标签**
- 显示数据点数值
- 标签位置和格式
- 自定义标签内容

**颜色主题**
- 预设颜色方案
- 自定义颜色配置
- 渐变色设置

**动画效果**
- 加载动画
- 数据更新动画
- 交互动画

## 🔄 实时数据更新

### 自动刷新配置

1. 在图表设置中启用 **"自动刷新"**
2. 设置刷新间隔（秒）：
   - 5秒 - 高频监控
   - 30秒 - 常规监控
   - 5分钟 - 低频监控

3. 配置刷新策略：
   - **追加模式** - 添加新数据点
   - **替换模式** - 完全刷新数据
   - **滑动窗口** - 保持固定时间范围

### 实时查询优化

**时间窗口查询**：
```sql
SELECT MEAN("value") AS "avg_value"
FROM "sensor_data" 
WHERE time > now() - 1h 
GROUP BY time(1m)
```

**最新数据查询**：
```sql
SELECT LAST("value") AS "latest_value"
FROM "sensor_data" 
WHERE time > now() - 5m
```

## 📱 响应式仪表板

### 仪表板布局

**网格系统**
- 12列网格布局
- 拖拽调整大小
- 自动对齐和吸附

**布局模式**
- **编辑模式** - 可拖拽和调整
- **查看模式** - 只读显示
- **全屏模式** - 单图表全屏

### 创建仪表板

1. 点击 **"新建仪表板"** 按钮
2. 设置仪表板基本信息：
   - 仪表板名称
   - 描述说明
   - 刷新间隔

3. 添加图表到仪表板：
   - 从图表库选择现有图表
   - 或创建新图表
   - 调整图表位置和大小

4. 保存仪表板配置

### 仪表板管理

**仪表板列表**
- 显示所有创建的仪表板
- 支持搜索和过滤
- 显示创建时间和修改时间

**仪表板操作**
- **查看** - 打开仪表板
- **编辑** - 修改仪表板布局
- **复制** - 基于现有仪表板创建新的
- **删除** - 删除仪表板
- **导出** - 导出仪表板配置

## 🎯 交互功能

### 图表交互

**缩放操作**
- 鼠标滚轮缩放
- 框选区域缩放
- 双击重置缩放

**平移操作**
- 拖拽平移视图
- 键盘方向键平移
- 平移边界限制

**数据点提示**
- 鼠标悬停显示详细信息
- 自定义提示内容
- 多系列数据对比

### 数据钻取

**时间钻取**
- 点击时间点查看详细数据
- 自动调整时间粒度
- 支持多级钻取

**维度钻取**
- 点击分类查看子分类
- 动态更新查询条件
- 面包屑导航

## 📤 图表导出

### 导出格式

**图片格式**
- PNG - 高质量位图
- JPEG - 压缩位图
- SVG - 矢量图形

**数据格式**
- CSV - 图表数据
- JSON - 完整配置
- Excel - 格式化数据

### 导出操作

1. 在图表右上角点击 **"导出"** 按钮
2. 选择导出格式和选项：
   - 图片尺寸和分辨率
   - 背景颜色
   - 包含标题和图例

3. 点击 **"下载"** 保存文件

## 💡 最佳实践

### 图表设计原则

**简洁明了**
- 避免过多的装饰元素
- 突出重要数据
- 使用合适的颜色对比

**数据准确**
- 确保查询逻辑正确
- 验证数据的时间范围
- 处理异常值和缺失值

**用户友好**
- 提供清晰的标题和标签
- 使用直观的颜色编码
- 添加必要的说明文字

### 性能优化

**查询优化**
- 限制数据时间范围
- 使用适当的聚合粒度
- 避免过于复杂的查询

**渲染优化**
- 控制数据点数量
- 使用数据采样
- 启用图表缓存

**刷新策略**
- 根据业务需求设置刷新频率
- 使用增量更新
- 避免不必要的全量刷新

## 🔧 故障排除

### 常见问题

**图表无数据显示**
- 检查查询语句是否正确
- 确认时间范围内有数据
- 验证字段映射配置

**图表显示异常**
- 检查数据类型是否匹配
- 确认图表类型是否合适
- 验证坐标轴配置

**性能问题**
- 减少数据点数量
- 优化查询语句
- 调整刷新频率

---

**数据可视化是 InfloWave 的亮点功能，通过图表可以更直观地理解数据。** 📈

下一步：[数据写入](./data-import.md)
